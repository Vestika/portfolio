<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ report_title }} - Vestika</title>
    <!--[if mso]>
    <style type="text/css">
        body, table, td {font-family: Arial, Helvetica, sans-serif !important;}
    </style>
    <![endif]-->
</head>
<body style="margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; line-height: 1.6; color: #1f2937; background-color: #f3f4f6;">
    <table role="presentation" style="width: 100%; border-collapse: collapse;">
        <tr>
            <td align="center" style="padding: 40px 20px;">
                <table role="presentation" style="width: 100%; max-width: 600px; border-collapse: collapse;">
                    <!-- Header -->
                    <tr>
                        <td style="background: linear-gradient(135deg, #10b981 0%, #3b82f6 100%); padding: 40px 30px; border-radius: 12px 12px 0 0; text-align: center;">
                            <h1 style="margin: 0; font-size: 28px; font-weight: 700; color: #ffffff;">
                                {{ report_title }}
                            </h1>
                            <p style="margin: 8px 0 0; font-size: 16px; color: rgba(255,255,255,0.9);">
                                Hello, {{ user_name }}
                            </p>
                            <p style="margin: 16px 0 0; font-size: 14px; color: rgba(255,255,255,0.85);">
                                {{ period_start|format_date }} - {{ period_end|format_date }}
                            </p>
                        </td>
                    </tr>

                    <!-- Body -->
                    <tr>
                        <td style="background-color: #ffffff; padding: 30px; border-radius: 0 0 12px 12px;">
                            <!-- Summary -->
                            <table role="presentation" style="width: 100%; border-collapse: collapse; margin-bottom: 30px;">
                                <tr>
                                    <td align="center" style="padding: 20px; background-color: #f9fafb; border-radius: 8px;">
                                        <p style="margin: 0; font-size: 32px; font-weight: 700; color: #10b981;">
                                            {{ total_value|format_currency(base_currency) }}
                                        </p>
                                        <p style="margin: 8px 0 0; font-size: 14px; color: #6b7280;">
                                            Total Portfolio Value
                                        </p>
                                    </td>
                                </tr>
                            </table>

                            <!-- Quick Stats -->
                            <table role="presentation" style="width: 100%; border-collapse: collapse; margin-bottom: 30px;">
                                <tr>
                                    <td align="center" style="padding: 16px; width: 50%;">
                                        <p style="margin: 0; font-size: 24px; font-weight: 700; color: #3b82f6;">
                                            {{ portfolios_count }}
                                        </p>
                                        <p style="margin: 4px 0 0; font-size: 13px; color: #6b7280;">
                                            {{ 'Portfolio' if portfolios_count == 1 else 'Portfolios' }}
                                        </p>
                                    </td>
                                    <td align="center" style="padding: 16px; width: 50%;">
                                        <p style="margin: 0; font-size: 24px; font-weight: 700; color: #3b82f6;">
                                            {{ total_holdings }}
                                        </p>
                                        <p style="margin: 4px 0 0; font-size: 13px; color: #6b7280;">
                                            Holdings
                                        </p>
                                    </td>
                                </tr>
                            </table>

                            <!-- Portfolios Summary -->
                            {% for portfolio in portfolios %}
                            <table role="presentation" style="width: 100%; border-collapse: collapse; margin-bottom: 20px; border: 1px solid #e5e7eb; border-radius: 8px;">
                                <tr>
                                    <td style="padding: 20px;">
                                        <h3 style="margin: 0 0 8px; font-size: 18px; font-weight: 600; color: #1f2937;">
                                            {{ portfolio.portfolio_name }}
                                        </h3>
                                        <p style="margin: 0; font-size: 24px; font-weight: 700; color: #10b981;">
                                            {{ portfolio.total_value|format_currency(portfolio.base_currency) }}
                                        </p>
                                        <p style="margin: 8px 0 0; font-size: 14px; color: #6b7280;">
                                            {{ portfolio.total_holdings }} holdings
                                        </p>

                                        {% if portfolio.top_holdings %}
                                        <!-- Top 3 Holdings -->
                                        <table role="presentation" style="width: 100%; border-collapse: collapse; margin-top: 16px;">
                                            <tr style="border-bottom: 1px solid #e5e7eb;">
                                                <td style="padding: 8px 0; font-size: 12px; font-weight: 600; color: #6b7280; text-transform: uppercase;">Top Holdings</td>
                                                <td style="padding: 8px 0; font-size: 12px; font-weight: 600; color: #6b7280; text-transform: uppercase; text-align: right;">Value</td>
                                            </tr>
                                            {% for holding in portfolio.top_holdings[:3] %}
                                            <tr>
                                                <td style="padding: 8px 0; font-size: 14px; color: #374151;">
                                                    <strong>{{ holding.symbol }}</strong>
                                                </td>
                                                <td style="padding: 8px 0; font-size: 14px; color: #374151; text-align: right;">
                                                    {{ holding.value|format_currency(portfolio.base_currency) }}
                                                </td>
                                            </tr>
                                            {% endfor %}
                                        </table>
                                        {% endif %}
                                    </td>
                                </tr>
                            </table>
                            {% endfor %}

                            <!-- CTA Button -->
                            <table role="presentation" style="width: 100%; border-collapse: collapse; margin: 30px 0;">
                                <tr>
                                    <td align="center">
                                        <a href="{{ app_url }}" style="display: inline-block; background: linear-gradient(135deg, #10b981 0%, #3b82f6 100%); color: #ffffff; padding: 14px 32px; font-size: 16px; font-weight: 600; text-decoration: none; border-radius: 8px;">
                                            View Full Report
                                        </a>
                                    </td>
                                </tr>
                            </table>

                            {% if has_pdf_attachment %}
                            <p style="text-align: center; font-size: 14px; color: #6b7280; margin-top: 20px;">
                                Your detailed PDF report is attached to this email.
                            </p>
                            {% endif %}
                        </td>
                    </tr>

                    <!-- Footer -->
                    <tr>
                        <td style="padding: 30px; text-align: center;">
                            <p style="margin: 0; font-size: 12px; color: #9ca3af;">
                                You're receiving this because you subscribed to portfolio reports.
                            </p>
                            <p style="margin: 8px 0 0; font-size: 12px; color: #9ca3af;">
                                <a href="{{ app_url }}/settings" style="color: #3b82f6; text-decoration: none;">Manage preferences</a>
                            </p>
                            <p style="margin: 16px 0 0; font-size: 11px; color: #d1d5db;">
                                This report is for informational purposes only and does not constitute financial advice.
                            </p>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
</body>
</html>
